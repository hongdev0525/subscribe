"use strict";(self.webpackChunk_N_E=self.webpackChunk_N_E||[]).push([[979],{7455:function(e,t,n){var a=n(7297),r=n(5893),i=n(7294),o=n(9521),l=n(5838),u=n(9971),c=n(4480),s=n(8767),d=n(5004),m=n(8264),p=n(3454);function h(){let e=(0,a.Z)(["\n  margin-bottom: 50px;\n  \n"]);return h=function(){return e},e}function f(){let e=(0,a.Z)([" \n  margin-bottom: 40px;\n  @media "," {\n    margin-bottom: 30px;\n  }\n"]);return f=function(){return e},e}function y(){let e=(0,a.Z)(["\n  color:tomato;\n"]);return y=function(){return e},e}function g(){let e=(0,a.Z)(["\n  margin-bottom: 20px;\n"]);return g=function(){return e},e}function b(){let e=(0,a.Z)(["\n  display:flex;\n  align-items: center;\n  font-size: 16px;\n  line-height: 22px;\n  font-weight: ",";\n  @media "," {\n    font-size: 14px;\n    line-height: 14px;\n    font-weight: ",";\n    padding-left: 5px;\n    margin-bottom: 5px;\n  }\n"]);return b=function(){return e},e}function x(){let e=(0,a.Z)(["\n  display: flex;\n  justify-content: center;\n  align-items: center;\n  width: 100%;\n  height: 56px;\n  font-size:18px;\n  font-weight: ",";\n  line-height: 38px;\n  border-radius: 5px;\n  @media "," {\n    width: 100%;\n    height: 48px;\n    font-size: 14px;\n    line-height: 13px;\n    font-weight: ",";\n    border-radius: 5px;\n\n  }\n"]);return x=function(){return e},e}let S=o.ZP.div(h()),v=o.ZP.div(f(),u.Uh.mobileL),I=o.ZP.p(y()),_=o.ZP.div(g()),k=(0,o.ZP)(u.AZ)(b(),(0,m.U)("semiBold"),u.Uh.mobileL,(0,m.U)("medium")),w=(0,o.ZP)(u.zx)(x(),(0,m.U)("bold"),u.Uh.mobileL,(0,m.U)("medium"));t.Z=function(e){let{stateKey:t}=e,n=(0,c.Zl)((0,d.R9)(t));(0,c.Zl)((0,d.U2)(t));let[a,o]=(0,i.useState)({paymentType:{value:"Card",validation:!0},paymentName:{value:"",validation:""},cardNumber:{value:"",validation:""},expiry:{value:"",validation:""},birth:{value:"",validation:""},pwd2Digit:{value:"",validation:""}}),{refetch:m}=(0,s.useQuery)("regPaymentInfo",()=>h(a),{enabled:!1,onSuccess:e=>{200===e.status&&("failed"===e.data.status?"duplicate"===e.data.error?alert("이미 등록된 결제수단입니다."):alert("결제수단 등록에 실패했습니다.".concat(e.data.message)):(alert("등록이 완료되었습니다."),n(t=>({...t,paymentNo:e.data.data,paymentModal:!1,paymentType:null}))))},onError:e=>{console.error("Error Occured : ",e)}}),h=async e=>{let t={};return Object.keys(e).forEach(n=>{t[n]=e[n].value}),await (0,l.Y)({method:"POST",withCredentials:!0,data:t,url:"".concat(p.env.NEXT_PUBLIC_API_SERVER,"/payment/issuebilling")})},f=e=>{o({...a,[e.currentTarget.name]:{value:e.currentTarget.value,validation:0!==e.currentTarget.value.length}})},y=e=>{for(let t in a)if(""===a[t].validation||!1===a[t].validation)return alert("카드 정보를 정확히 입력해주세요."),!1;m()};return(0,r.jsxs)(S,{children:[(0,r.jsxs)(v,{children:[(0,r.jsxs)(_,{children:[(0,r.jsxs)(k,{children:["카드 이름 ",(0,r.jsx)(I,{children:"*"})]}),(0,r.jsx)(u.II,{type:"text",name:"paymentName",value:a.paymentName.value,onChange:f,placeholder:"카드 이름을 입력해주세요. 예) 생활비카드,엄마카드"})]}),(0,r.jsxs)(_,{children:[(0,r.jsxs)(k,{children:["카드 번호 ",(0,r.jsx)(I,{children:"*"})]}),(0,r.jsx)(u.II,{type:"text",name:"cardNumber",maxLength:16,value:a.cardNumber.value,onChange:f,placeholder:"(-)하이픈 없이 입력해 주세요."})]}),(0,r.jsxs)(_,{children:[(0,r.jsxs)(k,{children:["카드 유효기간 ",(0,r.jsx)(I,{children:"*"})]}),(0,r.jsx)(u.II,{type:"text",name:"expiry",value:a.cardNumber.expiry,onChange:f,maxLength:4,placeholder:"월/년도(MMYY) 순서로 4자리 숫자를 입력해 주세요."})]}),(0,r.jsxs)(_,{children:[(0,r.jsxs)(k,{children:["생년월일 ",(0,r.jsx)(I,{children:"*"})]}),(0,r.jsx)(u.II,{type:"text",name:"birth",value:a.cardNumber.birth,onChange:f,maxLength:6,placeholder:"월/년도(MMYYDD) 순서로 6자리 숫자를 입력해 주세요. 예)940624"})]}),(0,r.jsxs)(_,{children:[(0,r.jsxs)(k,{children:["카드 비밀번호 앞 두자리 ",(0,r.jsx)(I,{children:"*"})]}),(0,r.jsx)(u.II,{type:"password",name:"pwd2Digit",value:a.cardNumber.pwd2Digit,onChange:f,maxLength:2,placeholder:"카드 비밀번호 앞 두자리를 입력해 주세요."})]})]}),(0,r.jsx)(w,{type:"button",onClick:()=>y(),children:"카드 등록하기"})]})}},9333:function(e,t,n){var a=n(7297),r=n(5893),i=n(9521),o=n(5838),l=n(4480),u=n(4410),c=n(3498),s=n(8767),d=n(5004),m=n(8264),p=n(9971),h=n(2836),f=n(7294),y=n(3454);function g(){let e=(0,a.Z)(["\n  width: 100%;\n  height: 56px;\n  font-weight: ",";\n  @media "," {\n    height: 37px;\n    }\n"]);return g=function(){return e},e}let b=(0,i.ZP)(h.XE)(g(),(0,m.U)("regular"),p.Uh.mobileL);t.Z=function(e){let{redirectUrl:t,failRedirectUrl:n,stateKey:a}=e,i=(0,l.sJ)(u.bw),m=(0,l.Zl)((0,d.R9)(a));(0,l.sJ)((0,d.R9)(a));let{refetch:p}=(0,s.useQuery)("issuekakaobilling",()=>h(),{enabled:!1,staleTime:1/0,retry:!1,onSuccess:e=>{200===e.status&&("fail"===e.data.status?alert("카카오페이 결제수단 등록에 실패했습니다."):(m(t=>({...t,paymentNo:e.data.data,paymentType:"Kakao",paymentModal:!1,addPayment:!1})),localStorage.removeItem("tmpSubscribeInfo")))},onError:e=>{console.error("Error Occured : ",e)}}),h=async()=>{let e=JSON.parse(localStorage.getItem("tmpSubscribeInfo"));return await (0,o.Y)({method:"POST",withCredentials:!0,data:{paymentCuid:e.paymentCuid,paymentType:e.paymentType,bankName:e.bankName,cardName:e.cardName},url:"".concat(y.env.NEXT_PUBLIC_API_SERVER,"/payment/issuekakaobilling")})},g=()=>{let e="KAKAO_CUID_".concat(new Date().getTime()),a={...i};a.paymentCuid=e,a.paymentType="Kakao",IMP.request_pay({pg:"kakaopay.TCSUBSCRIP",name:"  ",merchant_uid:"order_door_".concat(new Date().getTime()),pay_method:"kakaopay",m_redirect_url:"http://".concat(location.host)+t,amount:0,customer_uid:e},function(e){console.log("rps",e),!1===e.success?(alert("카카오페이 등록에 실패했습니다."),location.href=n):(console.log(e),a.bankName=e.bank_name?e.bank_name:"",a.cardName=e.card_name?e.card_name:"",localStorage.setItem("tmpSubscribeInfo",JSON.stringify(a)),p())})};return(0,c.O)(!1),(0,f.useEffect)(()=>{IMP.init("imp81502857")},[]),(0,r.jsx)(b,{type:"button",onClick:g,children:"카카오페이"})}},1019:function(e,t,n){var a=n(7297),r=n(5893),i=n(9521),o=n(5838),l=n(4480),u=n(4410),c=n(7294),s=n(1163),d=n(3498),m=n(8767),p=n(5004),h=n(2836),f=n(8264),y=n(9971),g=n(3454);function b(){let e=(0,a.Z)(["\n  width: 100%;\n  height: 48px;\n  font-size:12px;\n  font-weight: ",";\n  @media "," {\n    height: 37px;\n    }\n"]);return b=function(){return e},e}let x=(0,i.ZP)(h.XE)(b(),(0,f.U)("regular"),y.Uh.mobileL);t.Z=function(e){let{redirectUrl:t,failRedirectUrl:n,stateKey:a}=e;IMP.init("imp81502857");let i=(0,l.sJ)(u.bw),h=(0,l.Zl)((0,p.R9)(a)),{refetch:f}=(0,m.useQuery)("issuekakaobilling",()=>y(),{enabled:!1,staleTime:1/0,retry:!1,onSuccess:e=>{if(200===e.status){if("fail"===e.data.status)alert("카카오페이 결제수단 등록에 실패했습니다.");else{alert("카카오페이가 등록되었습니다."),h(t=>({...t,paymentNo:e.data.data}));let t=JSON.parse(localStorage.getItem("tmpSubscribeInfo")),n=Object.keys(t).filter(e=>"paymentType"!==e&&"paymentCuid"!==e).reduce((e,n)=>Object.assign(e,{[n]:t[n]}),{});localStorage.setItem("tmpSubscribeInfo",JSON.stringify(n))}}},onError:e=>{console.error("Error Occured : ",e)}}),y=async e=>{let t=JSON.parse(localStorage.getItem("tmpSubscribeInfo"));return await (0,o.Y)({method:"POST",withCredentials:!0,data:{paymentCuid:t.paymentCuid,paymentType:t.paymentType},url:"".concat(g.env.NEXT_PUBLIC_API_SERVER,"/payment/issuekakaobilling")})},b=()=>{let e="KAKAO_CUID_".concat(new Date().getTime()),a={...i};a.paymentCuid=e,a.paymentType="Kakao",localStorage.setItem("tmpSubscribeInfo",JSON.stringify(a)),IMP.request_pay({pg:"kakaopay.TCSUBSCRIP",merchant_uid:"order_door_".concat(new Date().getTime()),name:" ",pay_method:"kakaopay",m_redirect_url:"http://".concat(location.host)+t,amount:0,customer_uid:e},function(e){!1===e.success&&(alert("카카오페이 등록에 실패했습니다."),location.href=n)})};return(0,d.O)(!1),(0,c.useEffect)(()=>{let e=JSON.parse(localStorage.getItem("tmpSubscribeInfo"));if(!s.Router.query){let t=new URL(window.location).searchParams;console.log(t),0!==t.length&&e&&!0===JSON.parse(t.get("imp_success"))&&e.paymentType&&e.paymentCuid&&f()}return()=>{}},[]),(0,c.useEffect)(()=>{IMP.init("imp81502857")},[]),(0,r.jsx)(x,{type:"button",onClick:b,children:"카카오페이"})}},3498:function(e,t,n){n.d(t,{O:function(){return o}});var a=n(1163),r=n.n(a),i=n(7294);let o=e=>{(0,i.useEffect)(()=>{if(window.onbeforeunload=()=>{if(e)return"변경사항이 저장되지 않을 수 있습니다. 페이지를 벗어나시겠습니까?"},e){let t=()=>{let e=confirm("변경사항이 저장되지 않을 수 있습니다. 페이지를 벗어나시겠습니까?");if(!e)throw r().events.emit("routeChangeError"),"Abort route change. Please ignore this error."};return r().events.on("routeChangeStart",t),()=>{r().events.off("routeChangeStart",t)}}},[e])}},5004:function(e,t,n){n.d(t,{R9:function(){return o},U2:function(){return i},Vf:function(){return l}});var a=n(4480),r=n(5007);let i=(0,a.xu)({key:"cardState/".concat((0,r.Z)()),default:e=>({id:e,cardNumber:"",expiry:"",birth:"",pwd2Digit:""})}),o=(0,a.xu)({key:"deliveryDowState/".concat((0,r.Z)()),default:e=>({id:e,list:[],paymentNo:null,paymentModal:!1,paymentType:null,addPayment:!1})}),l=(0,a.cn)({key:"paymentHistoryState/".concat((0,r.Z)()),default:{list:[]}})}}]);