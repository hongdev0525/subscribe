(self.webpackChunk_N_E=self.webpackChunk_N_E||[]).push([[538],{4163:function(e,t,n){"use strict";var i=n(9521);n(1163);var r=n(5675),o=n.n(r),c=n(3735);n(7294);var a=n(5893),s=i.ZP.div.withConfig({displayName:"MypageTitle__MypageTitleWrapper",componentId:"sc-uuxqct-0"})(["position:relative;display:flex;align-items:center;padding-bottom:67px;border-bottom:1px solid #232323;@media ","{border-bottom:none;padding-bottom:0;margin-bottom:40px;}"],c.Uh.mobileL),u=i.ZP.div.withConfig({displayName:"MypageTitle__MypageTitleContainer",componentId:"sc-uuxqct-1"})(["text-align:center;width:100%;"]),l=i.ZP.div.withConfig({displayName:"MypageTitle__MypageTitleText",componentId:"sc-uuxqct-2"})(["font-size:28px;line-height:33px;font-weight:",";margin-bottom:12px;@media ","{font-size:20px;font-weight:",";}"],(0,c.Ue)("medium"),c.Uh.mobileL,(0,c.Ue)("regular")),p=i.ZP.div.withConfig({displayName:"MypageTitle__BackwardImageContainer",componentId:"sc-uuxqct-3"})(["position:absolute;left:0;top:17px;transform:translate(0%,-50%);img{cursor:pointer;}@media ","{img{width:28px;height:28px;}}"],c.Uh.mobileL);t.Z=function(e){var t=e.url,n=e.title,i=e.backward,r=function(e){location.href=e};return(0,a.jsxs)(s,{children:[!0===(void 0===i||i)&&(0,a.jsx)(p,{children:(0,a.jsx)(o(),{src:"/img/mypage/backward_icon.png",width:34,height:34,alt:"뒤로가기 아이콘",onClick:function(){return r(t)}})}),(0,a.jsx)(u,{children:(0,a.jsx)(l,{children:n})})]})}},5004:function(e,t,n){"use strict";n.r(t),n.d(t,{default:function(){return z}});var i=n(9521),r=n(7812),o=n(29),c=n(9499),a=n(7794),s=n.n(a),u=n(1163),l=n.n(u),p=n(1896),d=n(886),f=n(1748),m=n(9295);n(3289);var x=n(2544),h=n(2951),g=n(5885),y=n(4163),v=n(3735),w=n(4093),b=n(4480),_=n(5007),E=(0,b.cn)({key:"experienceState/".concat((0,_.Z)()),default:{subscribeType:"experience",product:[],period:1,deliveryDate:null,dows:[],addressNo:null,paymentNo:null,totalPrice:null,milesAmount:0,coupon:{}}}),j=n(7294),P=n(8767);n(35);var N=n(1569),I=n(129),O=n(7044),Z=n(8254);n(6779);var D=n(5893),C=n(3454);function S(e,t){var n=Object.keys(e);if(Object.getOwnPropertySymbols){var i=Object.getOwnPropertySymbols(e);t&&(i=i.filter(function(t){return Object.getOwnPropertyDescriptor(e,t).enumerable})),n.push.apply(n,i)}return n}function T(e){for(var t=1;t<arguments.length;t++){var n=null!=arguments[t]?arguments[t]:{};t%2?S(Object(n),!0).forEach(function(t){(0,c.Z)(e,t,n[t])}):Object.getOwnPropertyDescriptors?Object.defineProperties(e,Object.getOwnPropertyDescriptors(n)):S(Object(n)).forEach(function(t){Object.defineProperty(e,t,Object.getOwnPropertyDescriptor(n,t))})}return e}var U=i.ZP.div.withConfig({displayName:"Experience__ExperienceWrapper",componentId:"sc-ajy0tb-0"})(["display:flex;flex-direction:column;align-items:center;margin :142px 0 170px;@media ","{padding:80px 0px;margin:0px;}"],v.Uh.mobileL),k=i.ZP.div.withConfig({displayName:"Experience__ExperienceContainer",componentId:"sc-ajy0tb-1"})(["width:596px;min-height:100vh;@media ","{width:100%;padding:0 24px;}"],v.Uh.mobileL),J=i.ZP.div.withConfig({displayName:"Experience__ExperienceButtonContainer",componentId:"sc-ajy0tb-2"})(["display:flex;justify-content:center;width:100%;margin:24px auto;"]),L=(0,i.ZP)(v.zx).withConfig({displayName:"Experience__ExperienceButton",componentId:"sc-ajy0tb-3"})(["width:100%;border-radius:5px;font-size:18px;line-height:38px;font-weight:",";margin-top:40px;@media ","{border-radius:5px;margin-top:30px;}"],(0,N.U)("bold"),v.Uh.mobileL),M=i.ZP.div.withConfig({displayName:"Experience__MypageTitleContainer",componentId:"sc-ajy0tb-4"})(["width:800px;margin-bottom:5px;div{border-bottom:none;}@media ","{width:100%;padding:0 24px 0px;div{margin-bottom:0px;}}"],v.Uh.mobileL),A=i.ZP.div.withConfig({displayName:"Experience__ExperienceNotice",componentId:"sc-ajy0tb-5"})(["width:800px;height:145px;font-size:18px;line-height:26px;font-weight:",";background-color:#F1F1F5;border-radius:5px;padding:30px;margin-bottom :44px;span{font-weight:",";}@media ","{width:100%;height:100%;font-size:12px;line-height:20px;margin:18px  auto 40px;padding:20px 24px;}"],(0,N.U)("regular"),(0,N.U)("semiBold"),v.Uh.mobileL),R=function(){var e,t,n,i,c=(0,b.sJ)((0,w.TD)("experience")),a=(0,b.Zl)((0,w.TD)("experience")),u=(0,b.sJ)(E),v=(0,b.Zl)(E),_=(0,b.Zl)((0,w.cI)("experience")),N=(0,b.sJ)((0,I.R9)("experience")),S=(0,b.sJ)((0,w.cI)("experience")),R=(0,b.sJ)((0,O._)("experience")),F=(0,b.Zl)((0,O._)("experience")),z=(0,b.sJ)((0,w.FX)("experience")),B=(0,b.Zl)((0,w.FX)("experience")),X=(0,b.sJ)((0,Z.yM)("experience")),q=(0,b.sJ)((0,w.TD)("experience"));(0,b.Zl)((0,w.TD)("experience"));var K=(0,b.Zl)((0,Z.yM)("experience")),W=(0,b.Zl)((0,I.R9)("experience")),Q=function(){K(function(e){return T(T({},e),{},{addressList:[],addressNo:null,addModal:!1,addressAvailable:null})}),W(function(e){return[]}),v(function(e){return{subscribeType:"experience",product:[],period:1,deliveryDate:null,dows:[],addressNo:null,paymentNo:null,totalPrice:null,milesAmount:0,coupon:{}}}),a(function(){return[]}),B(function(){return[]}),F(function(){return[]}),_(function(e){return T(T({},e),{},{list:[]})})},V=(e=(0,o.Z)(s().mark(function e(){return s().wrap(function(e){for(;;)switch(e.prev=e.next){case 0:return e.next=2,(0,p.Y)({method:"GET",withCredentials:!0,url:"".concat(C.env.NEXT_PUBLIC_API_SERVER,"/login/check")});case 2:return e.abrupt("return",e.sent);case 3:case"end":return e.stop()}},e)})),function(){return e.apply(this,arguments)}),Y=(t=(0,o.Z)(s().mark(function e(){var t,n;return s().wrap(function(e){for(;;)switch(e.prev=e.next){case 0:return t=null,n=new URL(window.location).searchParams,0!==(0,r.Z)(n.keys()).length?!0===JSON.parse(n.get("imp_success"))&&((t=JSON.parse(localStorage.getItem("tmpExperienceInfo"))).impUid=n.get("imp_uid")):t=T({},u),e.next=5,(0,p.Y)({method:"POST",withCredentials:!0,data:t,url:"".concat(C.env.NEXT_PUBLIC_API_SERVER,"/subscribe/create")});case 5:return e.abrupt("return",e.sent);case 6:case"end":return e.stop()}},e)})),function(){return t.apply(this,arguments)}),G=(0,P.useQuery)(["submitExperience",u.impUid],Y,{enabled:null!=u.impUid&&0!=u.impUid.length,staleTime:1/0,retry:!1,refetchOnWindowFocus:!1,refetchOnmount:!1,refetchOnReconnect:!1,onSuccess:function(e){200===e.status&&("fail"===e.data.status?alert("결제 실패 :".concat(e.data.message)):(alert("체험하기 구매가 완료되었습니다."),Q(),localStorage.removeItem("tmpExperienceInfo"),l().replace("/mypage",void 0,{shallow:!1})))},onError:function(e){console.error("Error Occured : ",e)}}).refetch,H=(0,P.useQuery)("checkLogin",function(){return V()},{retry:!1,onSuccess:function(e){},onError:function(e){console.error("Error Occured : ",e)}}).refetch;(0,j.useEffect)(function(){v(function(e){return T(T({},e),{},{dows:q.list})})},[q.list]),(0,j.useEffect)(function(){var e=JSON.parse(localStorage.getItem("tmpExperienceInfo"));e?(v(e),_(function(t){return T(T({},t),{},{list:e.product})}),a(function(t){return T(T({},t),{},{list:e.dows})}),K(function(t){return T(T({},t),{},{addModal:!1,addressNo:e.addressNo})}),B(function(t){return T(T({},t),{},{deliveryDate:e.deliveryDate})})):Q()},[]),(0,j.useEffect)(function(){var e=JSON.parse(localStorage.getItem("tmpExperienceInfo")),t=new URL(window.location).searchParams;0!==t.length&&e&&(!0===JSON.parse(t.get("imp_success"))?G():!1===JSON.parse(t.get("imp_success"))&&localStorage.removeItem("tmpExperienceInfo"))},[]),(0,j.useEffect)(function(){return l().events.on("routeChangeStart",function(e){H(),Q(),localStorage.removeItem("tmpExperienceInfo")}),function(){window.onbeforeunload=function(){}}},[]);var $=function(e){var t=0,n=0;if(u){for(var i=0;i<u.dows.length;i++){for(var r=u.dows[i],o=0,c=0,a=0;a<e.length;a++){var s=e[a];r===s.dow&&(c+=s.amount,o+=parseInt(s.price)*s.amount)}c>=2&&n++,t+=o}return{totalPrice:t,defaultDiscountPrice:t-1e3*n,amountDiscount:n}}};return(0,j.useEffect)(function(){var e;if(S&&(null===(e=S.list)||void 0===e?void 0:e.length)!==0){var t=$(S.list),n=t.totalPrice,i=t.defaultDiscountPrice,r=t.amountDiscount;F(function(e){return T(T({},e),{},{milesAmount:0})}),v(function(e){return T(T({},e),{},{product:S.list,totalPrice:n,defaultDiscountPrice:i,amountDiscount:r})})}},[S.list]),(0,j.useEffect)(function(){v(function(e){return T(T({},e),{},{paymentNo:N.paymentNo,paymentType:N.paymentType})})},[N.paymentNo]),(0,j.useEffect)(function(){(null==u?void 0:u.totalPrice)<parseInt(R.milesAmount)?(F(function(e){return T(T({},e),{},{milesAmount:u.totalPrice})}),v(function(e){return T(T({},e),{},{coupon:R.coupon,milesAmount:u.totalPrice})})):v(function(e){return T(T({},e),{},{coupon:R.coupon,milesAmount:R.milesAmount})})},[R.coupon,R.milesAmount]),(0,j.useEffect)(function(){v(function(e){return T(T({},e),{},{deliveryDate:z.deliveryDate})})},[z.deliveryDate]),(0,j.useEffect)(function(){IMP.init("imp81502857")},[]),(0,j.useEffect)(function(){v(function(e){return T(T({},e),{},{addressNo:X.addressNo})})},[X.addressNo]),(0,D.jsxs)(U,{children:[(0,D.jsx)(M,{children:(0,D.jsx)(y.Z,{url:"/",title:"체험하기"})}),(0,D.jsxs)(A,{children:[(0,D.jsx)("p",{children:"- 선택한 횟수(요일)만큼 배송이 돼요."}),(0,D.jsx)("p",{children:"- 주 1회 배송은 오박이(보냉가방)가 아닌 하루체험팩(일회용)으로 배송이 돼요. "}),(0,D.jsx)("p",{children:"- 체험 상품은  하루 쉬어가기 및 하루 수량변경(취소)이 불가해요."})]}),(0,D.jsxs)(k,{children:[(0,D.jsx)(d.Z,{stateKey:"experience"}),c&&(null===(n=c.list)||void 0===n?void 0:n.length)>=1&&(0,D.jsxs)(D.Fragment,{children:[(0,D.jsx)(f.Z,{selectedDowList:c.list,stateKey:"experience",experience:!0}),(0,D.jsx)(x.Z,{stateKey:"experience"})]}),c&&(null===(i=c.list)||void 0===i?void 0:i.length)>=1&&(null==u?void 0:u.deliveryDate)!=null&&(null==u?void 0:u.length)!==0&&(0,D.jsxs)(D.Fragment,{children:[(0,D.jsx)(m.Z,{stateKey:"experience"}),(0,D.jsx)(h.Z,{stateKey:"experience",subscribePrice:u.defaultDiscountPrice}),(0,D.jsx)(g.Z,{paymentDetails:u,experience:!0}),(0,D.jsx)(J,{children:(0,D.jsx)(L,{onClick:function(){var e=u.product;if(0===e.length)return alert("상품 수량을 선택해주세요."),!1;if(0!==e.length)for(var t=0;t<c.length;t++){for(var n=c[t],i=!1,r=0;r<e.length;r++)if(e[r].dow===n){i=!0;break}if(!1===i)return alert("".concat(n,"요일 상품 수량을 선택해주세요.")),!1}if(!u.deliveryDate)return alert("배송 시작일을 선택해주세요."),!1;if(!u.addressNo)return alert("배송 주소를 입력해주세요."),!1;var o=T({},u);localStorage.setItem("tmpExperienceInfo",JSON.stringify(o)),IMP.request_pay({pg:"nice.nictest00m",pay_method:"card",merchant_uid:"order_monthly_".concat(Date.now()),name:"  - 체험하기",m_redirect_url:"http://".concat(location.host)+"/experience",amount:u.defaultDiscountPrice-parseInt(u.milesAmount)},function(e){!0===e.success&&"paid"===e.status?v(function(t){return T(T({},t),{},{impUid:e.imp_uid})}):(alert("결제에 실패했습니다. 다시 시도해주세요."),localStorage.removeItem("tmpExperienceInfo"))})},children:"체험하기"})})]})]})]})},F=i.ZP.div.withConfig({displayName:"experience__ExperienceMainWrapper",componentId:"sc-6rja47-0"})(["display:flex;align-items:center;flex-direction:column;width:100%;"]),z=function(){return(0,D.jsx)(F,{children:(0,D.jsx)(R,{})})}},2824:function(e,t,n){(window.__NEXT_P=window.__NEXT_P||[]).push(["/experience",function(){return n(5004)}])}},function(e){e.O(0,[230,674,255,345,411,774,888,179],function(){return e(e.s=2824)}),_N_E=e.O()}]);